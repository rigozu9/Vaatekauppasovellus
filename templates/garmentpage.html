{% include 'header.html' %}
{% include 'search.html' %}

<!-- Garment rendered here -->
<ul class="garmentpage-grid">
    {% for item in clothing %}
        <li class="garmentpage-item">
            <div class="item-container">
                <!-- Display an image from the database -->
                <div class="slideshow-container">
                    {% for image in item.images %}
                        <div class="mySlides fade">
                            <img class="garmentpage-image" src="data:image/jpeg;base64,{{ image.data | b64encode }}" alt="Clothing">
                        </div>
                    {% endfor %}
                    <!-- Next and previous buttons -->
                    <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                    <a class="next" onclick="plusSlides(1)">&#10095;</a>
                </div>
                <div class="details-container">
                    <p><strong>{{ item.name }}</strong></p>
                    <p><strong>Category:</strong> {{ item.category }}</p>
                    <p><strong>About the item:</strong> <br>{{ item.description }}</br></p>
                    <p><strong>Size:</strong> {{ item.size }}</p>
                    <p><strong>Price:</strong> {{ item.price }}â‚¬</p>
                    <!-- links to check inquiries and modify or delete item. -->
                    {% if session.username == item.username %}
                        <p><a href="/{{ session.username }}/chats/{{ item.id }}">See inquiries</a></p>
                        <p><a href="/modify/{{ item.id }}">MODIFY ITEM</a></p>
                        <p><a href="/delete/{{ item.id }}" onclick="return confirm('Are you sure you want to delete this item?');">DELETE ITEM</a></p>
                    {% else %}
                        <!-- link to send messsage about the item -->
                        <p><strong>Listed by: </strong><a href="/users/{{ item.username }}">{{ item.username }}</a></p>
                        <p><a href="/send_message/{{ session.username }}/{{ item.id }}">Send a message about the item</a></p>
                    {% endif %}
                </div>
            </div>
        </li>
    {% endfor %}
</ul>

{% if session.username %}
    <!-- User is logged in, show logout link -->
    <a class="usertab" href="/users/{{ session.username }}"> {{ session.username }}</a>
    <a class="logout" href="/logout">Sign out</a>
    <a class="sell" href="/new">Sell a garment</a>
{% else %}
    <!-- User is not logged in, show login and register links -->
    <a class="login" href="/login">Sign in</a>
    <a class="register" href="/register">Register here</a>
{% endif %}

<!-- footer -->
{% include 'footer.html' %}

<!-- Manual slideshow for the pictures -->
<script>
    var slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
        showSlides(slideIndex += n);
    }

    function currentSlide(n) {
        showSlides(slideIndex = n);
    }

    function showSlides(n) {
        var i;
        var slides = document.getElementsByClassName("mySlides");
        if (n > slides.length) {slideIndex = 1}
        if (n < 1) {slideIndex = slides.length}
        for (i = 0; i < slides.length; i++) {
            slides[i].style.display = "none";
        }
        slides[slideIndex-1].style.display = "block";
    }
</script>
